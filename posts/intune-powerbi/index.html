<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Get Intune data with PowerBI | Nosari20</title><meta name=description content="How to get Intune data from PowerBI report?"><meta name=author content="Florent NOSARI"><meta name=google-site-verification content="l3oU_IprnsBv0fmr4tY7n9XdxnmZ0oum0x1GeGe5hkI"><meta property="og:url" content="https://nosari20.github.io/posts/intune-powerbi/"><meta property="og:title" content="Get Intune data with PowerBI | Nosari20"><meta property="og:author" content="Florent NOSARI"><meta property="og:description" content="How to get Intune data from PowerBI report?"><meta property="og:image" content="https://nosari20.github.io/posts/intune-powerbi/_og.png"><meta property="og:article:published_time" content="2022-08-31 00:00:00 +0000 UTC"><meta property="og:article:modified_time" content="2022-09-01 00:00:00 +0000 UTC"><meta property="og:type" content="article"><meta name=twitter:card content="summary_large_image"><meta property="twitter:domain" content="nosari20.github.io"><meta property="twitter:url" content="https://nosari20.github.io/posts/intune-powerbi/"><meta name=twitter:title content="Get Intune data with PowerBI | Nosari20"><meta name=twitter:description content="How to get Intune data from PowerBI report?"><meta name=twitter:image content="https://nosari20.github.io/posts/intune-powerbi/_og.png"><meta name=theme-color content="#302F2A"><link rel=icon href=/images/favicon.png><link rel=stylesheet href="/css/styles.css?v=2.1"><link rel=stylesheet href="/css/print.css?v=1.0" media=print></head><body><nav><div id=nav-toggle><svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 17h18a1 1 0 01.117 1.993L21 19H3a1 1 0 01-.117-1.993L3 17h18H3zm0-6 18-.002a1 1 0 01.117 1.993l-.117.007L3 13a1 1 0 01-.117-1.993L3 11l18-.002L3 11zm0-6h18a1 1 0 01.117 1.993L21 7H3a1 1 0 01-.117-1.993L3 5h18H3z" fill="#fff"/></svg></div><a href=/><svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.248 16.002c.966.0 1.75.784 1.75 1.75v2.498A1.75 1.75.0 016.248 22H3.75A1.75 1.75.0 012 20.25v-2.498c0-.966.784-1.75 1.75-1.75h2.498zM9.748 18h11.505a.75.75.0 01.102 1.493l-.102.007H9.748a.75.75.0 01-.102-1.493L9.748 18h11.505H9.748zm-3.5-8.999c.966.0 1.75.784 1.75 1.75v2.498a1.75 1.75.0 01-1.75 1.75H3.75A1.75 1.75.0 012 13.249V10.75C2 9.784 2.784 9 3.75 9h2.498zM9.748 11h11.505a.75.75.0 01.102 1.493l-.102.007H9.748a.75.75.0 01-.102-1.493L9.748 11h11.505H9.748zm-3.5-9c.966.0 1.75.784 1.75 1.75v2.498a1.75 1.75.0 01-1.75 1.75H3.75A1.75 1.75.0 012 6.248V3.75C2 2.784 2.784 2 3.75 2h2.498zm3.5 2h11.505a.75.75.0 01.102 1.493l-.102.007H9.748a.75.75.0 01-.102-1.493L9.748 4h11.505H9.748z" fill="#fff"/></svg>Home</a>
<a href=/tags/device-management/><svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.254 8.003c.967.0 1.75.784 1.75 1.75v9.5a1.75 1.75.0 01-1.75 1.75H3.75A1.75 1.75.0 012 19.253v-9.5c0-.966.784-1.75 1.75-1.75h4.504zm-2.002 9.495h-.5a.75.75.0 100 1.5h.5a.75.75.0 000-1.5zM21.25 16.5a.75.75.0 01.102 1.493L21.25 18H11v-1.5h10.25zM18.25 5c.966.0 1.75.784 1.75 1.75v7.5A1.75 1.75.0 0118.25 16H11V9A2 2 0 009.15 7.006L9 7H4v-.25C4 5.784 4.784 5 5.75 5h12.5z" fill="#fff"/></svg>Device Management</a>
<a href=/tags/dev-scripting/><svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m8.086 18.611 5.996-14.004a1 1 0 011.878.677l-.04.11-5.996 14.004a1 1 0 01-1.878-.677l.04-.11 5.996-14.004L8.086 18.61zm-5.793-7.318 4-4a1 1 0 011.497 1.32l-.083.094L4.414 12l3.293 3.293a1 1 0 01-1.32 1.498l-.094-.084-4-4a1 1 0 01-.083-1.32l.083-.094 4-4-4 4zm14-4.001a1 1 0 011.32-.083l.093.083 4.001 4.001a1 1 0 01.083 1.32l-.083.095-4.001 3.995a1 1 0 01-1.497-1.32l.084-.095L19.584 12l-3.293-3.294a1 1 0 010-1.414z" fill="#fff"/></svg>Dev. / Scripting</a>
<a href=/tags/misc/><svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9 4.5v6.238c0 .375-.094.744-.273 1.074L7.54 14h8.922l-1.188-2.188A2.25 2.25.0 0115 10.738V4.5h1A.75.75.0 0016 3H8a.75.75.0 000 1.5h1zm8.275 11H6.725l-1.582 2.915A1.75 1.75.0 006.68 21h10.638a1.75 1.75.0 001.538-2.585L17.275 15.5z" fill="#fff"/></svg>Misc.</a><footer><p class="footer text-center">Copyright (©) 2022 Florent NOSARI</p></footer></nav><section><header>Nosari20</header><article><image class=image-header alt="Get Intune data with PowerBI" src=/posts/intune-powerbi/_header.png><h1><a class=title href=/posts/intune-powerbi/>Get Intune data with PowerBI</a></h3><div class=metadata>Published on: <time datetime=2022-08-31>Aug 31, 2022</time>
- Last update: <time datetime=2022-09-01>Sep 1, 2022</time><div class=meta-url>Url: https://nosari20.github.io/posts/intune-powerbi/</div><ul class=tags><li><a href=https://nosari20.github.io/tags/device-management>device-management</a></li><li><a href=https://nosari20.github.io/tags/dev-scripting>dev-scripting</a></li><li><a href=https://nosari20.github.io/tags/misc>misc</a></li></ul></div><p><h2 id=content>Content</h2><ul><li>Use Intune data whareouse</li><li>Use Graph API (advanced)</li><li>Sources / usefull resources</li></ul><h2 id=use-intune-data-whareouse>Use Intune data whareouse</h2><ol><li>In Microsoft Endpoint Manager portal go to <code>Reports > Intune data warehouse > Data warehouse</code> and copy the OData feed URL</li></ol><p><img src=/posts/intune-powerbi/intune-odata-feed.png alt="Intune OData feed URL"></p><ol start=2><li>In PowerBi create a new OData data source</li></ol><p><img src=/posts/intune-powerbi/create-odata-feed.png alt="Create a new OData data source"></p><ol start=3><li>Paste OData feed URL</li></ol><p><img src=/posts/intune-powerbi/paste-odata-feed.png alt="Paste OData feed URL"></p><ol start=4><li>Choose <code>Organizational account</code> as authentication method</li></ol><p><img src=/posts/intune-powerbi/auth-organizational-account.png alt="Choos authentication method"></p><ol start=5><li>Select desired tables then click <code>Load</code></li></ol><p><img src=/posts/intune-powerbi/choose-tables.png alt="Select tables"></p><h2 id=use-graph-api-advanced>Use Graph API (advanced)</h2><h3 id=why-use-graph-api>Why use Graph API?</h3><p>Intune data warehouse has a limited set of available data tables. For example, you cannot filter devices by group membership. Using Graph API can resolve this limitation but we cannot browse the whole database with Graph API so it will be difficult to create relationships between results.</p><h3 id=prerequisites>Prerequisites</h3><ul><li>Create app registration in Azure</li></ul><h3 id=custom-query-using-powerquery-m-language>Custom query using PowerQuery M language</h3><ol><li>Create a blank query</li></ol><p><img src=/posts/intune-powerbi/select-blank-query.png alt="Create blank query"></p><ol start=2><li>Open advanced editor for the created query</li></ol><p><img src=/posts/intune-powerbi/open-advanced-editor.png alt="Open advanced editor"></p><ol start=3><li>Use the following code</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c++ data-lang=c++><span style=display:flex><span>let
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Step 1: Get OAuth token
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    token_uri <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;https://login.windows.net/&#34;</span> <span style=color:#f92672>&amp;</span> <span style=color:#960050;background-color:#1e0010>#</span><span style=color:#e6db74>&#34;Directory ID&#34;</span> <span style=color:#f92672>&amp;</span> <span style=color:#e6db74>&#34;/oauth2/token&#34;</span>,
</span></span><span style=display:flex><span>    resource<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://graph.microsoft.com&#34;</span>,
</span></span><span style=display:flex><span>    tokenResponse <span style=color:#f92672>=</span> Json.Document(Web.Contents(token_uri,
</span></span><span style=display:flex><span>    [
</span></span><span style=display:flex><span>        Content <span style=color:#f92672>=</span> Text.ToBinary(Uri.BuildQueryString(
</span></span><span style=display:flex><span>            [
</span></span><span style=display:flex><span>                client_id <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>#</span><span style=color:#e6db74>&#34;Client ID&#34;</span>, <span style=color:#75715e>//managed parameter
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                resource <span style=color:#f92672>=</span> resource,
</span></span><span style=display:flex><span>                grant_type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;client_credentials&#34;</span>, <span style=color:#75715e>//managed parameter
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                client_secret <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>#</span><span style=color:#e6db74>&#34;Client Secret&#34;</span> <span style=color:#75715e>//managed parameter
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            ]
</span></span><span style=display:flex><span>        )),
</span></span><span style=display:flex><span>        Headers <span style=color:#f92672>=</span> [Accept <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;application/json&#34;</span>], ManualStatusHandling <span style=color:#f92672>=</span> {<span style=color:#ae81ff>400</span>}
</span></span><span style=display:flex><span>    ])),
</span></span><span style=display:flex><span>    access_token <span style=color:#f92672>=</span> tokenResponse[access_token],
</span></span><span style=display:flex><span>    bearer <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Bearer &#34;</span> <span style=color:#f92672>&amp;</span> access_token,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Step 2: Perform http request and covert the result to JSON
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    GetJson <span style=color:#f92672>=</span> Json.Document(Web.Contents(<span style=color:#e6db74>&#34;https://graph.microsoft.com/beta/users?&#34;</span>, [Headers<span style=color:#f92672>=</span>[Accept<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;application/json&#34;</span>, Authorization<span style=color:#f92672>=</span>bearer]])),
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Step 3: Convert JSON to table ()
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Result <span style=color:#f92672>=</span> Table.FromRecords(GetJson[value])
</span></span><span style=display:flex><span>in
</span></span><span style=display:flex><span>    Result
</span></span></code></pre></div><ol start=4><li>Create managed parameters for <code>Directory ID</code>, <code>Client ID</code> and <code>Client Secret</code></li></ol><p><img src=/posts/intune-powerbi/create-new-parameter-1.png alt="Create new parameter - step 1"></p><p><img src=/posts/intune-powerbi/create-new-parameter-2.png alt="Create new parameter - step 2"></p><ol start=5><li>Edit permissions and privacy for each data source</li></ol><p><img src=/posts/intune-powerbi/permissions.png alt="Edit permission and privacy"></p><ol start=6><li>Click on <code>Refresh Preview</code> et voilà!</li></ol><p><img src=/posts/intune-powerbi/results.png alt=Result></p><h3 id=next-steps>Next steps</h3><ul><li>Find a way to create relations</li><li>Dynamic queries based on filters</li></ul><h2 id=sources--usefull-resources>Sources / usefull resources</h2><ul><li><a href=https://minkus.medium.com/easily-connecting-between-power-query-power-bi-and-microsoft-graph-72333eb95a35>https://minkus.medium.com/easily-connecting-between-power-query-power-bi-and-microsoft-graph-72333eb95a35</a></li><li><a href=https://docs.microsoft.com/en-us/graph/auth-register-app-v2>https://docs.microsoft.com/en-us/graph/auth-register-app-v2</a></li><li><a href=https://docs.microsoft.com/en-us/graph/auth-v2-service>https://docs.microsoft.com/en-us/graph/auth-v2-service</a></li><li><a href=https://docs.microsoft.com/en-us/powerquery-m/json-document>https://docs.microsoft.com/en-us/powerquery-m/json-document</a></li><li><a href=https://docs.microsoft.com/en-us/powerquery-m/web-contents>https://docs.microsoft.com/en-us/powerquery-m/web-contents</a></li></ul></p></article><div id=comments><script>var id="4",commentsDiv;if(id){let t="https://github.com/nosari20/nosari20.github.io/issues/".concat(id),n="https://api.github.com/repos/nosari20/nosari20.github.io/issues/".concat(id,"/comments");commentsDiv=document.getElementById("comments");let e=new XMLHttpRequest;e.responseType="json",e.open("GET",n),e.setRequestHeader("Accept","application/vnd.github.v3.html+json"),e.send(),e.onload=function(){if(e.status!=200){let e=document.createElement("p");e.innerHTML="<i>Comments for this post yet are not opened yet (or you have GitHub scripts disabled).</i>",commentsDiv.appendChild(e)}else{let n=e.response,s=document.createElement("h2");s.innerHTML="Comments: ".concat(n.length),commentsDiv.appendChild(s);let o=document.createElement("p");o.innerHTML="<i>You can leave a comment using this <a href='".concat(t,"' target='_blank'>GitHub issue</a>.</i>"),commentsDiv.appendChild(o),n.forEach(function(e){let t=document.createElement("div");t.setAttribute("class","gh-comment"),t.innerHTML="".concat("<div class='gh-header'>","<img src='",e.user.avatar_url,"' />","<div style='margin:auto 0;'>","<b><a class='gh-username' href='",e.user.html_url,"' target='_blank'>",e.user.login,e.user.login=="nosari20"?" (OP)":"","</a></b>","<em> on ",new Date(e.created_at).toLocaleString("en"),"</em>","</div>","</div>","<div class='gh-body'>",e.body_html,"</div>"),commentsDiv.appendChild(t)})}},e.onerror=function(){let e=document.createElement("p");e.innerHTML="<i>Some error loading comments.</i>",commentsDiv.appendChild(e)}}</script></div></section><script src="/js/app.js?v=1.0"></script></body></html>