<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Cryptography basics | Nosari20</title>
<meta name=description content="How can Alice send data to Bob securely?"><meta name=author content="Florent NOSARI"><meta name=google-site-verification content="l3oU_IprnsBv0fmr4tY7n9XdxnmZ0oum0x1GeGe5hkI"><meta property="og:url" content="https://nosari20.github.io/posts/cryptography-basics/"><meta property="og:title" content="Cryptography basics | Nosari20"><meta property="og:author" content="Florent NOSARI"><meta property="og:description" content="How can Alice send data to Bob securely?"><meta property="og:image" content="https://nosari20.github.io/posts/cryptography-basics/_og.png"><meta property="og:article:published_time" content="2022-12-13 00:00:00 +0000 UTC"><meta property="og:article:modified_time" content="2022-12-13 00:00:00 +0000 UTC"><meta property="og:type" content="article"><meta name=twitter:card content="summary_large_image"><meta property="twitter:domain" content="nosari20.github.io"><meta property="twitter:url" content="https://nosari20.github.io/posts/cryptography-basics/"><meta name=twitter:title content="Cryptography basics | Nosari20"><meta name=twitter:description content="How can Alice send data to Bob securely?"><meta name=twitter:image content="https://nosari20.github.io/posts/cryptography-basics/_og.png"><meta name=theme-color content="#302F2A"><link rel=icon href=/images/favicon.png><link rel=stylesheet href="/css/styles.css?v=2.1"><link rel=stylesheet href="/css/print.css?v=1.0" media=print><style>.has-mathjax{visibility:hidden}span.has-mathjax mjx-container{display:inline-block!important}</style><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script>window.MathJax={startup:{pageReady:()=>MathJax.startup.defaultPageReady().then(()=>{for(let e of document.getElementsByClassName("has-mathjax"))e.style.visibility="visible"})}}</script></head><body><nav><div id=nav-toggle><svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 17h18a1 1 0 01.117 1.993L21 19H3a1 1 0 01-.117-1.993L3 17h18H3zm0-6 18-.002a1 1 0 01.117 1.993l-.117.007L3 13a1 1 0 01-.117-1.993L3 11l18-.002L3 11zm0-6h18a1 1 0 01.117 1.993L21 7H3a1 1 0 01-.117-1.993L3 5h18H3z" fill="#fff"/></svg></div><a href=/><svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.248 16.002c.966.0 1.75.784 1.75 1.75v2.498A1.75 1.75.0 016.248 22H3.75A1.75 1.75.0 012 20.25v-2.498c0-.966.784-1.75 1.75-1.75h2.498zM9.748 18h11.505a.75.75.0 01.102 1.493l-.102.007H9.748a.75.75.0 01-.102-1.493L9.748 18h11.505H9.748zm-3.5-8.999c.966.0 1.75.784 1.75 1.75v2.498a1.75 1.75.0 01-1.75 1.75H3.75A1.75 1.75.0 012 13.249V10.75C2 9.784 2.784 9 3.75 9h2.498zM9.748 11h11.505a.75.75.0 01.102 1.493l-.102.007H9.748a.75.75.0 01-.102-1.493L9.748 11h11.505H9.748zm-3.5-9c.966.0 1.75.784 1.75 1.75v2.498a1.75 1.75.0 01-1.75 1.75H3.75A1.75 1.75.0 012 6.248V3.75C2 2.784 2.784 2 3.75 2h2.498zm3.5 2h11.505a.75.75.0 01.102 1.493l-.102.007H9.748a.75.75.0 01-.102-1.493L9.748 4h11.505H9.748z" fill="#fff"/></svg>
Home
</a><a href=/tags/device-management/><svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.254 8.003c.967.0 1.75.784 1.75 1.75v9.5a1.75 1.75.0 01-1.75 1.75H3.75A1.75 1.75.0 012 19.253v-9.5c0-.966.784-1.75 1.75-1.75h4.504zm-2.002 9.495h-.5a.75.75.0 100 1.5h.5a.75.75.0 000-1.5zM21.25 16.5a.75.75.0 01.102 1.493L21.25 18H11v-1.5h10.25zM18.25 5c.966.0 1.75.784 1.75 1.75v7.5A1.75 1.75.0 0118.25 16H11V9A2 2 0 009.15 7.006L9 7H4v-.25C4 5.784 4.784 5 5.75 5h12.5z" fill="#fff"/></svg>
Device Management
</a><a href=/tags/dev-scripting/><svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m8.086 18.611 5.996-14.004a1 1 0 011.878.677l-.04.11-5.996 14.004a1 1 0 01-1.878-.677l.04-.11 5.996-14.004L8.086 18.61zm-5.793-7.318 4-4a1 1 0 011.497 1.32l-.083.094L4.414 12l3.293 3.293a1 1 0 01-1.32 1.498l-.094-.084-4-4a1 1 0 01-.083-1.32l.083-.094 4-4-4 4zm14-4.001a1 1 0 011.32-.083l.093.083 4.001 4.001a1 1 0 01.083 1.32l-.083.095-4.001 3.995a1 1 0 01-1.497-1.32l.084-.095L19.584 12l-3.293-3.294a1 1 0 010-1.414z" fill="#fff"/></svg>
Dev. / Scripting
</a><a href=/tags/misc/><svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9 4.5v6.238c0 .375-.094.744-.273 1.074L7.54 14h8.922l-1.188-2.188A2.25 2.25.0 0115 10.738V4.5h1A.75.75.0 0016 3H8a.75.75.0 000 1.5h1zm8.275 11H6.725l-1.582 2.915A1.75 1.75.0 006.68 21h10.638a1.75 1.75.0 001.538-2.585L17.275 15.5z" fill="#fff"/></svg>
Misc.</a><footer><p class="footer text-center">Copyright (Â©) 2022 Florent NOSARI</p></footer></nav><section><header>Nosari20</header><article><image class=image-header alt="Cryptography basics" src=/posts/cryptography-basics/_header.png><h1><a class=title href=/posts/cryptography-basics/>Cryptography basics</a></h3><div class=metadata>Published on: <time datetime=2022-12-13>Dec 13, 2022</time>
- Last update: <time datetime=2022-12-13>Dec 13, 2022</time><div class=meta-url>Url: https://nosari20.github.io/posts/cryptography-basics/</div><ul class=tags><li><a href=https://nosari20.github.io/tags/misc>misc</a></li><li><a href=https://nosari20.github.io/tags/security>security</a></li><li><a href=https://nosari20.github.io/tags/cryptography>cryptography</a></li></ul></div><p><h2 id=content>Content</h2><ul><li>Preamble</li><li>symmetric encryption</li><li>Asymertric encryption</li><li>Hash functions</li><li>Digital signature</li><li>Protocols</li><li>Digital certificates</li><li>Common usages</li></ul><h2 id=preamble>Preamble</h2><h3 id=who-are-alice-and-bob>Who are Alice and Bob?</h3><p>Alice and Bob are fictional characters used in cryptography to illustrate scenarios (source : <a href=https://en.wikipedia.org/wiki/Alice_and_Bob>Wikipedia</a>).</p><p>The main characters are the following:</p><ul><li>Alice: the sender</li><li>Bob: the recipient</li><li>Eve: passive attacker (listens to conversations)</li><li>Mallory: active attacker (listens, modifies or impersonates conversations)</li></ul><h3 id=notation>Notation</h3><table><thead><tr><th>Notation</th><th>Description</th></tr></thead><tbody><tr><td><span class=has-mathjax>$$ K_s $$</span></td><td>Secret/Shared key</td></tr><tr><td><span class=has-mathjax>$$ K_{priv}^X $$</span></td><td>X&rsquo;s private key</td></tr><tr><td><span class=has-mathjax>$$ K_{pub}^X $$</span></td><td>X&rsquo;s public key</td></tr><tr><td><span class=has-mathjax>$$ E(K,M) $$</span></td><td>Encrypt message M with key K</td></tr><tr><td><span class=has-mathjax>$$ D(K,C) $$</span></td><td>Decrypt cipher C with key K</td></tr><tr><td><span class=has-mathjax>$$ S(K,M) $$</span></td><td>Sign message M with key K</td></tr><tr><td><span class=has-mathjax>$$ V(K,M) $$</span></td><td>Verify that M is signed with private key associated with key K</td></tr><tr><td><span class=has-mathjax>$$ h(X) $$</span></td><td>Hash of X</td></tr><tr><td><span class=has-mathjax>$$ N_x $$</span></td><td>Nonce (unique random number), x represents the instance</td></tr></tbody></table><h2 id=symmetric-encryption>Symmetric encryption</h2><p>The simplest way to share data securely is using symmetric encryption (e.g. <a href=https://fr.wikipedia.org/wiki/Advanced_Encryption_Standard>AES</a>). In this scenario, Alice and Bob agreed on a share key <span class=has-mathjax>$$ K_s $$</span> beforehand and then encrypt the messages with it. All messages are encrypted with the same key.</p><h3 id=basic-protocol>Basic protocol</h3><ol start=0><li>Alice and Bob agreed on a shared key <span class=has-mathjax>$$ K_s $$</span> using an already secured and authenticated channel</li><li>Alice encrypts plain text <span class=has-mathjax>$$ M $$</span> as <span class=has-mathjax>$$ E(K_s,M) \to C $$</span></li><li>Alice sends cipher <span class=has-mathjax>$$ C $$</span> to Bob</li><li>Bob decrypts cipher as <span class=has-mathjax>$$ D(K_s,C) \to M $$</span></li></ol><h3 id=limitations>Limitations</h3><ol><li>Alice and Bob have a secured and authenticated channel to share keys</li><li>If <span class=has-mathjax>$$ K_s $$</span> is leaked, Eve can decrypt all the conversations in live or afterward and Mallory can create new messages</li><li>Mallory can replay some messages after being sent by Alice or Bob. This can be mitigated by using nonce to authenticate messages (first nonce sent by Alice on a secured and authenticated channel)</li></ol><h2 id=asymmetric-encryption>Asymmetric encryption</h2><p>Asymmetric encryption (e.g. <a href=https://en.wikipedia.org/wiki/RSA_(cryptosystem)>RSA</a>) removes the need for a secure channel as a prerequisite for the conversation as it uses a publicly shareable key <span class=has-mathjax>$$ K_{pub} $$</span> to encrypt data and a private key <span class=has-mathjax>$$ K_{priv} $$</span> to decrypt data.</p><h3 id=basic-protocol-1>Basic protocol</h3><ol start=0><li>Alice and Bob share their public keys <span class=has-mathjax>$$ K_{pub}^{Alice} $$</span> and <span class=has-mathjax>$$ K_{pub}^{Bob} $$</span> on a public channel</li><li>Alice encrypts plain text <span class=has-mathjax>$$ M $$</span> as <span class=has-mathjax>$$ E(K_{pub}^{Bob},M) \to C $$</span></li><li>Alice sends cipher <span class=has-mathjax>$$ C $$</span> to Bob</li><li>Bob decrypts cipher as <span class=has-mathjax>$$ D(K_{priv}^{Bob},C) \to M $$</span></li></ol><h3 id=limitations-1>Limitations</h3><ol><li>Mallory can replay some messages after being sent by Alice or Bob, this can be mitigated by using nonce to authenticate messages (first non send by Alice on a secured and authenticated channel)</li><li>Asymmetric encryption algorithms consume more resources than symmetric encryption ones</li></ol><h2 id=hash-functions>Hash functions</h2><p>Hash functions <span class=has-mathjax>$$ h(X) $$</span> (e.g. <a href=https://en.wikipedia.org/wiki/Secure_Hash_Algorithms>SHA</a>)) are used to convert data of any length to a fixed length data. This operation cannot be undone by design. Plain text cannot be retrieved from hash (note: some implementations are weak, so input can be retrieved and it is possible to find multiple values for the same hash). Hash functions are used to check data integrity and in authentication processes.</p><h3 id=basic-protocol-2>Basic protocol</h3><ol start=0><li>Alice and Bob agreed on a nonce <span class=has-mathjax>$$ N_0 $$</span> using an already secured and authenticated channel</li><li>Alice hash plain text <span class=has-mathjax>$$ M $$</span> and nonce <span class=has-mathjax>$$ N_0 $$</span> as <span class=has-mathjax>$$ h(M,N_0) \to H_{MN_0} $$</span></li><li>Alice send plain text <span class=has-mathjax>$$ M $$</span> and hash to Bob <span class=has-mathjax>$$ H_{MN_0} $$</span> to Bob</li><li>Bob hash received plain text <span class=has-mathjax>$$ M_r $$</span> and nonce <span class=has-mathjax>$$ N_0 $$</span> as <span class=has-mathjax>$$ h(M_r,N_0) \to H_{M_rN_0} $$</span> and compare it to received hash from Alice</li><li>If <span class=has-mathjax>$$ H_{M_rN_0} = H_{MN_0} $$</span> then, this means that message <span class=has-mathjax>$$ M_r $$</span> is equal to <span class=has-mathjax>$$ M $$</span> and so is from Alice (the message is authenticated).</li></ol><h3 id=limitations-2>Limitations</h3><ol><li>Alice and Bob have a secured and authenticated channel to share first nonce</li><li>In this example, nothing is encrypted and so Eve can read everything</li></ol><h2 id=digital-signature>Digital signature</h2><p>Digital signature (e.g. <a href=https://en.wikipedia.org/wiki/RSA_(cryptosystem)>RSA</a>) are used to authenticate data using asymmetric encryption keys without any authenticated channel as a prerequisite of the conversation. The sender signs data using his own private key <span class=has-mathjax>$$ K_{priv} $$</span> (the data hash is signed instead of the full data), and the recipient authenticates the data received using the sender&rsquo;s public key <span class=has-mathjax>$$ K_{pub} $$</span>.</p><h3 id=basic-protocol-3>Basic protocol</h3><ol><li>Alice sends message <span class=has-mathjax>$$ M $$</span> with signature <span class=has-mathjax>$$ S(K_{priv}^{Alice},h(L)) $$</span> to Bob</li><li>Bob receives message <span class=has-mathjax>$$ M_r $$</span> and verifies that it is signed with Alice&rsquo;s private key using a verification algorithm as <span class=has-mathjax>$$ V(K_{pub}^{Alice},h(M_r) $$</span>. If <span class=has-mathjax>$$ V $$</span> returns true, then this means that message <span class=has-mathjax>$$ M_r $$</span> is equal to <span class=has-mathjax>$$ M $$</span> and so is from Alice (the message is authenticated).</li></ol><h3 id=limitations-3>Limitations</h3><ol><li>Mallory can replay messages</li><li>In this example, nothing is encrypted and so Eve can read everything</li><li>Bob has to make sure that <span class=has-mathjax>$$ K_{pub}^{Alice} $$</span> is really owned by Alice and not by Mallory</li></ol><h2 id=protocols>Protocols</h2><p>Cryptographic protocols (e.g. <a href=https://en.wikipedia.org/wiki/Transport_Layer_Security>TLS</a> wrapp-up all the above systems to create secured and authenticated channel, they have to prevent the following attacks types (not exhaustive):</p><ul><li>Read (live and after session)</li><li>Replay</li><li>Modification</li><li>Repudiation</li><li>Impersonation</li></ul><h2 id=digital-certificates-aka-public-key-certificates>Digital certificates (aka public key certificates)</h2><p>Digital certificates (e.g. <a href=https://fr.wikipedia.org/wiki/X.509>x509 certificates</a>) aim to authenticate public keys with a trust chain system (each certificate is signed by an &lsquo;issuer&rsquo; until reaching certification authority signature which must be trusted by devices/users). A digital certificate contains multiple fields including public key, common name of the public key owner, serial number, validity and issuer identity (see example below).</p><div><img alt="Wikipedia.org digital certificate" src=/posts/cryptography-basics/wikipedia-certificate.png style="max-width:340px;margin:auto;display:block;border:1px solid #000"></div><h2 id=common-usages>Common usages</h2><h3 id=secure-web-browsing>Secure web browsing</h3><h4 id=scenario>Scenario</h4><p>Alice navigates to a website <code>bob.io</code> using HTTPS and so her browser authenticates server and encrypts data.</p><h4 id=prerequisites>Prerequisites</h4><ul><li><code>bob.io</code> must have a public trusted certificate (i.e. signed by a certificate authority which is shipped with OS) or Alice must trust <code>bob.io</code> certificate authority (e.g. for intranet).</li></ul><h4 id=diagram>Diagram</h4><p><img src=/posts/cryptography-basics/server-athentication.drawio.png alt="Secure web browsing diagram"></p><h3 id=password-authentication>Password authentication</h3><h4 id=scenario-1>Scenario</h4><p>Alice logged to <code>https://bob.io</code> using her password.</p><h4 id=prerequisites-1>Prerequisites</h4><ul><li>Alice must be registered on <code>bob.io</code></li></ul><h4 id=diagram-1>Diagram</h4><p><img src=/posts/cryptography-basics/password-auth.drawio.png alt="Password authentication"></p><h3 id=file-integrity>File integrity</h3><h4 id=scenario-2>Scenario</h4><p>Alice downloads a file from <code>https://bob.io</code> and wants to verify the file integrity to make sure that the file was not altered during download.</p><h4 id=prerequisites-2>Prerequisites</h4><ul><li><code>bob.io</code> must provide a hash values of files available for download (usually multiple values using multiple algorithms).</li></ul><h4 id=diagram-2>Diagram</h4><p><img src=/posts/cryptography-basics/file-integrity.drawio.png alt="File integrity check"></p><h3 id=mail-signature-aka-smime>Mail signature (aka S/MIME)</h3><h4 id=scenario-3>Scenario</h4><p>Alice sent a signed and encrypted mail to Bob (they don&rsquo;t use the same mail server).</p><h4 id=prerequisites-3>Prerequisites</h4><ul><li>Bob and Alice must have their own certificate with private key issued by a certificate authority which is trusted by both (CAs can be different)</li><li>Alice&rsquo;s server must host Alice&rsquo;s public key</li><li>Bob&rsquo;s server must host Bob&rsquo;s public key</li></ul><h4 id=diagram-3>Diagram</h4><p><img src=/posts/cryptography-basics/secure-email.drawio.png alt="Secure email"></p><h2 id=sources--usefull-resources>Sources / usefull resources</h2><ul><li><a href=https://en.wikipedia.org/wiki/Alice_and_Bob>https://en.wikipedia.org/wiki/Alice_and_Bob</a></li><li><a href=https://en.wikipedia.org/wiki/RSA>https://en.wikipedia.org/wiki/RSA</a>_</li><li><a href=https://www.devglan.com/online-tools/rsa-encryption-decryption>https://www.devglan.com/online-tools/rsa-encryption-decryption</a></li><li><a href=https://en.wikipedia.org/wiki/Secure_Hash_Algorithms>https://en.wikipedia.org/wiki/Secure_Hash_Algorithms</a></li><li><a href=https://en.wikipedia.org/wiki/Transport_Layer_Security>https://en.wikipedia.org/wiki/Transport_Layer_Security</a></li><li><a href=https://fr.wikipedia.org/wiki/Advanced_Encryption_Standard>https://fr.wikipedia.org/wiki/Advanced_Encryption_Standard</a></li><li><a href=https://fr.wikipedia.org/wiki/X.509>https://fr.wikipedia.org/wiki/X.509</a></li></ul></p></article><div id=comments><script>var id="6",commentsDiv;if(id){let t="https://github.com/nosari20/nosari20.github.io/issues/".concat(id),n="https://api.github.com/repos/nosari20/nosari20.github.io/issues/".concat(id,"/comments");commentsDiv=document.getElementById("comments");let e=new XMLHttpRequest;e.responseType="json",e.open("GET",n),e.setRequestHeader("Accept","application/vnd.github.v3.html+json"),e.send(),e.onload=function(){if(e.status!=200){let e=document.createElement("p");e.innerHTML="<i>Comments for this post yet are not opened yet (or you have GitHub scripts disabled).</i>",commentsDiv.appendChild(e)}else{let n=e.response,s=document.createElement("h2");s.innerHTML="Comments: ".concat(n.length),commentsDiv.appendChild(s);let o=document.createElement("p");o.innerHTML="<i>You can leave a comment using this <a href='".concat(t,"' target='_blank'>GitHub issue</a>.</i>"),commentsDiv.appendChild(o),n.forEach(function(e){let t=document.createElement("div");t.setAttribute("class","gh-comment"),t.innerHTML="".concat("<div class='gh-header'>","<img src='",e.user.avatar_url,"' />","<div style='margin:auto 0;'>","<b><a class='gh-username' href='",e.user.html_url,"' target='_blank'>",e.user.login,e.user.login=="nosari20"?" (OP)":"","</a></b>","<em> on ",new Date(e.created_at).toLocaleString("en"),"</em>","</div>","</div>","<div class='gh-body'>",e.body_html,"</div>"),commentsDiv.appendChild(t)})}},e.onerror=function(){let e=document.createElement("p");e.innerHTML="<i>Some error loading comments.</i>",commentsDiv.appendChild(e)}}</script></div></section><script src="/js/app.js?v=1.0"></script></body></html>